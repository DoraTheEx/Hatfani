Group Policy Preferences (GPP) הן הרחבה של Group Policy שהוצגה על ידי Microsoft כדי לספק שליטה גרנולרית יותר על הגדרות שונות בסביבת Windows. GPP מאפשרת למנהלים להגדיר הגדרות מפורטות עבור חשבונות משתמשים ומחשבים, כולל כוננים ממופים, משימות מתוזמנות, משתמשים וקבוצות מקומיים ועוד, ישירות מממשק ניהול Group Policy.

בעוד ש-GPP משפרת מאוד את יכולות הניהול על ידי פישוט הקונפיגורציה של הגדרות מורכבות, היא הציגה פרצת אבטחה משמעותית. אחת הבעיות הבולטות ביותר עם GPP הייתה הטיפול שלה בסיסמאות. מנהלים יכלו להשתמש ב-GPP כדי להגדיר חשבונות משתמשים וקבוצות מקומיים, וזה כלל גם את היכולת להגדיר סיסמאות עבור חשבונות אלו. הבעיה התעוררה מהאופן שבו סיסמאות אלו נשמרו והועברו.

GPP שמרה את הסיסמאות המוגדרות ב-Group Policy Objects (GPOs) בצורה מוצפנת בתיקיית SYSVOL על בקרי תחום (domain controllers). תיקייה זו נגישה לכל המשתמשים המאומתים בדומיין, כלומר כל משתמש יכול לגשת לקבצים אלו. שיטת ההצפנה שהשתמשה בה GPP הייתה חלשה וניתנת לפענוח בקלות. Microsoft השתמשה במפתח סטטי להצפנת הסיסמאות, ומפתח זה פורסם בפומבי כחלק מהתיעוד של MSDN, מה שהפך את זה לפשוט עבור תוקפים לפענח את הסיסמאות.

תוקף יכול לנצל פרצה זו באמצעות השלבים הבאים:
1. **גישה ל-SYSVOL:** התוקף, שיש לו כל רמת גישה מאומתת לדומיין, יכול לנווט לתיקיית SYSVOL שבה נשמרים GPOs.
2. **איתור קבצי GPP:** התוקף יכול לחפש קבצי XML בתוך SYSVOL המכילים הגדרות GPP, במיוחד קבצים המכילים שדות סיסמאות מוצפנות.
3. **פענוח סיסמאות:** באמצעות המפתח הסטטי הזמין בפומבי, התוקף יכול לפענח את הסיסמאות המופיעות בקבצי GPP אלו.
4. **השגת גישה עם הרשאות גבוהות:** הסיסמאות המפוענחות יכולות להיות עבור חשבונות מנהל מקומי במחשבים שונים או אפילו עבור חשבונות שירות עם הרשאות משמעותיות. התוקף יכול להשתמש בסיסמאות אלו כדי להשיג גישה לא מורשית למערכות, ובכך להסלים את ההרשאות ולפרוץ משאבים נוספים ברשת.

פרצה זו הייתה מסוכנת במיוחד כי היא אפשרה הסלמת הרשאות פשוטה ממשתמש דומיין ברמת נמוכה לגישה ניהולית ברמה גבוהה. בהבנה על חומרת הנושא, Microsoft שחררה עדכוני אבטחה והנחיות שהמליצו למנהלים להפסיק להשתמש ב-GPP להגדרת סיסמאות ולהסיר כל אישורי כניסה קיימים שהוגדרו באמצעות GPP.

כדי להקטין את סיכון זה, מנהלים צריכים:
- **להסיר סיסמאות GPP:** לזהות ולהסיר כל מדיניות GPP שמגדירה סיסמאות.
- **שימוש בשיטות חלופיות:** להשתמש בשיטות מאובטחות יותר לניהול סיסמאות, כמו Group Managed Service Accounts (gMSAs) או פתרונות ניהול גישה פריבילגית (PAM) של צד שלישי.
- **ביקורות סדירות:** לערוך ביקורות סדירות על SYSVOL וחלקים אחרים בספריה כדי לוודא שאין מידע רגיש שנחשף בטעות.

על ידי התמודדות עם נושאים אלו, ארגונים יכולים להפחית משמעותית את הסיכון שנובע מפרצת GPP זו ולהגן טוב יותר על סביבות ה-Windows שלהם מפני התקפות פוטנציאליות.
